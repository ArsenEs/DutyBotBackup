import random
import pandas as pd
from telegram import Bot
from datetime import datetime
import asyncio

# –ó–∞–º–µ–Ω–∏—Ç–µ 'YOUR_BOT_TOKEN' –Ω–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
BOT_TOKEN = '7297307785:AAGhIXH3gXFG6yTPbZLBrjpAhfvTlr8nvfc'
CHAT_ID = '-1002154831062'   #—Ç–µ—Å—Ç–æ–≤—ã–π = -4576590267,   –ø—Ä–æ–¥ = -1002154831062

# –°–ø–∏—Å–æ–∫ —Ü–∏—Ç–∞—Ç
MOTIVATIONAL_QUOTES = [
    "–ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ —Ç—ã –ª—É—á—à–∏–π! üí™",
    "–ú—É—Å–æ—Ä –Ω–µ —É–±–µ—Ä–µ—Ç—Å—è —Å–∞–º, –∞ —Ç—ã —Å–º–æ–∂–µ—à—å! üöÄ",
    "–ü–æ–º–Ω–∏, —á–∏—Å—Ç–æ—Ç–∞ ‚Äî –∑–∞–ª–æ–≥ –∑–¥–æ—Ä–æ–≤—å—è! üßπ",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å –±—ã—Ç—å –≥–µ—Ä–æ–µ–º! üåü",
    "–£–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –∑–∞—Ä—è–¥ –±–æ–¥—Ä–æ—Å—Ç–∏ –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å! üí•",
    "–¢—ã —Å–ø–æ—Å–æ–±–µ–Ω —Å–¥–µ–ª–∞—Ç—å –æ—Ñ–∏—Å —á–∏—â–µ! üöÄ",
    "–ß–∏—Å—Ç–æ—Ç–∞ –æ—Ñ–∏—Å–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ç–µ–±—è! üåü",
    "–ö—Ç–æ, –µ—Å–ª–∏ –Ω–µ —Ç—ã, –Ω–∞–≤–µ–¥—ë—Ç –ø–æ—Ä—è–¥–æ–∫! üßº",
    "–£–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å –Ω–∞—á–∞–ª–æ –≤–µ–ª–∏–∫–∏—Ö –¥–µ–ª! üèÜ",
    "–¢—Ä—É–¥–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —à–∞–Ω—Å —Å—Ç–∞—Ç—å —Å–∏–ª—å–Ω–µ–µ, –Ω–∞—á–Ω–∏ —Å —É–±–æ—Ä–∫–∏! üí™",
    "–ß–∏—Å—Ç—ã–π –æ—Ñ–∏—Å ‚Äî –∑–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏! ‚ú®",
    "–°–µ–≥–æ–¥–Ω—è ‚Äî —Ç–≤–æ–π —à–∞–Ω—Å –≤–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥ –≤ —á–∏—Å—Ç–æ—Ç—É! üåø",
    "–¢—ã ‚Äî –º–∞—Å—Ç–µ—Ä —á–∏—Å—Ç–æ—Ç—ã –∏ –ø–æ—Ä—è–¥–∫–∞! üëë",
    "–í—Ä–µ–º—è –Ω–∞–≤–µ—Å—Ç–∏ –±–ª–µ—Å–∫, –≤–ø–µ—Ä–µ–¥ –∫ –ø–æ–±–µ–¥–µ –Ω–∞–¥ –±–µ—Å–ø–æ—Ä—è–¥–∫–æ–º! üßΩ",
    "–ß–∏—Å—Ç—ã–π –æ—Ñ–∏—Å ‚Äî –∫–∞–∫ –Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –Ω–∞—á–Ω–∏ —Å –Ω–µ–≥–æ! üìñ",
    "–°–µ–≥–æ–¥–Ω—è –æ—Ñ–∏—Å –±—É–¥–µ—Ç —Å–∏—è—Ç—å, –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–µ–±–µ! üåü",
    "–ß–µ–º —á–∏—â–µ –æ—Ñ–∏—Å, —Ç–µ–º —Å–≤–µ—Ç–ª–µ–µ –º—ã—Å–ª–∏! üí°",
    "–¢—ã –∫–∞–∫ —Å—É–ø–µ—Ä–≥–µ—Ä–æ–π —á–∏—Å—Ç–æ—Ç—ã, –æ—Ñ–∏—Å —Ç–µ–±—è –∂–¥—ë—Ç! ü¶∏‚Äç‚ôÇÔ∏è",
    "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞–≤–æ–¥–∏—Ç —è—Å–Ω–æ—Å—Ç—å –≤ –º—ã—Å–ª—è—Ö! üí≠",
    "–ß–∏—Å—Ç—ã–π –æ—Ñ–∏—Å ‚Äî –∫–∞–∫ —á–∏—Å—Ç—ã–π –ª–∏—Å—Ç, –≥–æ—Ç–æ–≤—ã–π –∫ –Ω–æ–≤—ã–º –∏–¥–µ—è–º! üìù",
    "–ß–µ–º –º–µ–Ω—å—à–µ –º—É—Å–æ—Ä–∞ –≤–æ–∫—Ä—É–≥, —Ç–µ–º –±–æ–ª—å—à–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è! ‚ú®",
    "–£–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –∫–∞–∫ –º–µ–¥–∏—Ç–∞—Ü–∏—è, –ø–æ–ø—Ä–æ–±—É–π! üßò‚Äç‚ôÇÔ∏è",
    "–í–º–µ—Å—Ç–µ –º—ã —Å–¥–µ–ª–∞–µ–º –æ—Ñ–∏—Å –ª—É—á—à–∏–º –º–µ—Å—Ç–æ–º –¥–ª—è —Ä–∞–±–æ—Ç—ã! ü§ù",
    "–ö–∞–∂–¥–∞—è –≤–µ—â—å –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ ‚Äî —É—Å–ø–µ—Ö –±–ª–∏–∑–æ–∫! üóÇ",
    "–£–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –≤–∫–ª–∞–¥ –≤ –æ–±—â–µ–µ –¥–µ–ª–æ! üåç",
    "–ß–∏—Å—Ç–æ—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞–≥–æ–≤, –Ω–æ –±–æ–ª—å—à–∏—Ö –¥–µ–ª! üöÄ",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã ‚Äî –≥–µ—Ä–æ–π —á–∏—Å—Ç–æ—Ç—ã! üèÖ",
    "–£–±–µ—Ä–∏ –Ω–µ–º–Ω–æ–≥–æ, –∞ –ø–æ–ª—É—á–∏—à—å –º–Ω–æ–≥–æ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞! üéâ",
    "–ß–∏—Å—Ç–æ—Ç–∞ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–∞–º–∞, —Ç—ã —Ç–≤–æ—Ä–∏—à—å –µ—ë! ‚ú®",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å–æ–∑–¥–∞—ë—à—å —É—é—Ç –≤ –Ω–∞—à–µ–º –æ—Ñ–∏—Å–µ! üè†",
    "–ü—ã–ª—å –Ω–µ –∏–º–µ–µ—Ç —à–∞–Ω—Å–æ–≤, –∫–æ–≥–¥–∞ —Ç—ã –≤ –¥–µ–ª–µ! üí®",
    "–°–Ω–∞—á–∞–ª–∞ —É–±–æ—Ä–∫–∞, –ø–æ—Ç–æ–º –∫–æ—Ñ–µ! ‚òï",
    "–í—Å—ë –±—É–¥–µ—Ç —á–∏—Å—Ç–æ, –∫–∞–∫ —Å–ª–µ–∑–∞ –µ–¥–∏–Ω–æ—Ä–æ–≥–∞! ü¶Ñ",
    "–°–µ–π—á–∞—Å –Ω–∞–≤–µ–¥–µ–º –ø–æ—Ä—è–¥–æ–∫ –∏ –º–æ–∂–Ω–æ –≤ –æ—Ç–ø—É—Å–∫! üå¥",
    "–£–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞! ü¶∏‚Äç‚ôÄÔ∏è",
    "–ú—É—Å–æ—Ä –Ω–µ –æ—Ç—Å—Ç–æ–∏—Ç, –∫–æ–≥–¥–∞ —Ç—ã –Ω–∞ —Å—Ç—Ä–∞–∂–µ —á–∏—Å—Ç–æ—Ç—ã! üî•",
    "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞–≤–æ–¥–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –æ—Ñ–∏—Å–µ, –Ω–æ –∏ –≤ –∂–∏–∑–Ω–∏! üßò‚Äç‚ôÄÔ∏è",
    "–¢—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ —É–±–∏—Ä–∞–µ—à—å, —Ç—ã –¥–µ–ª–∞–µ—à—å –æ—Ñ–∏—Å –≤–µ–ª–∏–∫–∏–º! üëë",
    "–ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ —É–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –º–∏–Ω–∏-–∫–∞—Ä–¥–∏–æ! üèÉ‚Äç‚ôÇÔ∏è",
    "–ß–∏—Å—Ç–æ—Ç–∞ –æ—Ñ–∏—Å–∞ ‚Äî –∫–∞–∫ —á–∏—Å—Ç–∞—è —Å–æ–≤–µ—Å—Ç—å: –ø—Ä–∏—è—Ç–Ω–æ –∏ –ª–µ–≥–∫–æ! üòå",
    "–ö–æ–≥–¥–∞ –æ—Ñ–∏—Å —á–∏—Å—Ç, –º—ã—Å–ª–∏ —Ç–µ–∫—É—Ç —Å–≤–æ–±–æ–¥–Ω–µ–µ! üí°",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –Ω–µ –¥–µ–∂—É—Ä–Ω—ã–π, —Ç—ã –≤–æ–ª—à–µ–±–Ω–∏–∫ —á–∏—Å—Ç–æ—Ç—ã! ‚ú®",
    "–£–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –ø—É—Ç—å –∫ –æ—Ñ–∏—Å–Ω–æ–π –≥–∞—Ä–º–æ–Ω–∏–∏! üßò‚Äç‚ôÇÔ∏è",
    "–° —á–∏—Å—Ç–æ—Ç–æ–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å! üîß",
    "–û—Ñ–∏—Å ‚Äî —Ç–≤–æ—è –∫—Ä–µ–ø–æ—Å—Ç—å, –∞ —É–±–æ—Ä–∫–∞ ‚Äî —Ç–≤–æ–π –º–µ—á! ‚öîÔ∏è",
    "–ß–∏—Å—Ç—ã–π –æ—Ñ–∏—Å ‚Äî –∑–∞–ª–æ–≥ –º–∏—Ä–Ω–æ–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã! üïäÔ∏è",
    "–ü–æ—Å–ª–µ —É–±–æ—Ä–∫–∏ —Ä–∞–±–æ—Ç–∞ –ø–æ–π–¥—ë—Ç –±—ã—Å—Ç—Ä–µ–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ! üíº",
    "–°—É–ø–µ—Ä–≥–µ—Ä–æ–∏ —Ç–æ–∂–µ —É–±–∏—Ä–∞—é—Ç! ü¶∏‚Äç‚ôÇÔ∏è",
    "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞ —Ä–∞–±–æ—á–µ–º –º–µ—Å—Ç–µ ‚Äî –ø–æ—Ä—è–¥–æ–∫ –≤ –∂–∏–∑–Ω–∏! üíº",
    "–ß–∏—Å—Ç—ã–π –æ—Ñ–∏—Å ‚Äî –∫–∞–∫ –Ω–æ–≤–∞—è –∑–∞—Ä—è–¥–∫–∞ –¥–ª—è —Ç–≤–æ–µ–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏! üîã",
    "–¢—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ —É–±–∏—Ä–∞–µ—à—å, —Ç—ã —Å–æ–∑–¥–∞—ë—à—å –ø–æ—Ä—è–¥–æ–∫! üöÄ",
    "–ú—É—Å–æ—Ä, –±–µ—Ä–µ–≥–∏—Å—å, —Å–µ–π—á–∞—Å —Ç—ã –±—É–¥–µ—à—å –ø–æ–±–µ–∂–¥—ë–Ω! üóëÔ∏è",
    "–ß–∏—Å—Ç–æ—Ç–∞ ‚Äî —ç—Ç–æ –∫–∞–∫ –∏—Å–∫—É—Å—Å—Ç–≤–æ, –∏ —Ç—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –º–∞—Å—Ç–µ—Ä! üé®",
    "–ü—ã–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, —Å –∫–µ–º —Å–≤—è–∑–∞–ª–∞—Å—å! üßº"
]


# –ü—É—Ç—å –∫ –≤–∞—à–µ–º—É —Ñ–∞–π–ª—É Excel
EXCEL_FILE = 'C://Users/Admin/DutyBotProject/duty.xlsx'

# –ü—É—Ç—å –∏–ª–∏ URL –∫ –≤–∞—à–µ–º—É GIF
GIF_URL = 'https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExeDN2MWk1ajNiMGt1ZjRhYWVpdnlmNjA5YzRxcnduMGFmNDRpYm9uMSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/NV4cSrRYXXwfUcYnua/giphy.gif'  # –ü—Ä–∏–º–µ—Ä URL –∫ GIF

def get_random_quote():
    return random.choice(MOTIVATIONAL_QUOTES)

def get_duty_today(excel_file):
    df = pd.read_excel(excel_file)
    today = datetime.today().strftime('%Y-%m-%d')
    today_row = df[df['Date'] == today]
    if not today_row.empty:
        return today_row.iloc[0]['Names']
    return None

async def send_duty_message(bot_token, chat_id, caption):
    bot = Bot(token=bot_token)
    await bot.send_message(chat_id=chat_id, text=caption)

if __name__ == '__main__':
    duty_today = get_duty_today(EXCEL_FILE)
    if duty_today:
        today_date = datetime.today().strftime('%Y-%m-%d')
        # –ó–¥–µ—Å—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        caption = (
            f"{today_date}\n\n"
            "–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ!\n"
            f"–°–µ–≥–æ–¥–Ω—è –¥–µ–∂—É—Ä–Ω—ã–µ:\n{duty_today}\n\n"
            "–ó–∞–¥–∞—á–∞: –°–æ–±—Ä–∞—Ç—å –º—É—Å–æ—Ä –ø–æ –≤—Å–µ–º—É –æ—Ñ–∏—Å—É, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ –Ω–∞ –∫—Ä—ã–ª—å—Ü–µ –æ—Ñ–∏—Å–∞. "
            "–ù–∞–≤–µ—Å—Ç–∏ –ø–æ—Ä—è–¥–æ–∫ –Ω–∞ –∫—É—Ö–Ω–µ.\n\n"
            f"{get_random_quote()}"
        )
        # –ó–∞–ø—É—Å–∫–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
        asyncio.run(send_duty_message(BOT_TOKEN, CHAT_ID, caption))
    else:
        print("–°–µ–≥–æ–¥–Ω—è –¥–µ–∂—É—Ä–Ω—ã—Ö –Ω–µ—Ç –∏–ª–∏ –¥–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ")





